<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ stats['nome'] }} - Dia {{ stats['dia'] }}</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header class="game-header">
            <div class="header-info">
                <h1>ğŸ›ï¸ {{ stats['nome'] }}</h1>
                <p class="dia">ğŸ“… Dia {{ stats['dia'] }}</p>
            </div>
            <div class="header-actions">
                <form action="/proximo_turno" method="POST" style="display: inline;">
                    <button type="submit" class="btn btn-primary">â­ï¸ PrÃ³ximo Turno</button>
                </form>
                % if defined('usuario') and usuario['username'] == 'admin':
                <form action="/logs" method="GET" style="display: inline;">
                    <button type="submit" class="btn btn-secondary">ğŸ“Š Logs</button>
                </form>
                % end
                <form action="/reiniciar" method="POST" style="display: inline;">
                    <button type="submit" class="btn btn-danger" onclick="return confirm('Deseja realmente reiniciar?')">ğŸ”„ Reiniciar</button>
                </form>
            </div>
        </header>

        % if condicoes['status'] != 'jogando':
        <div class="alert alert-{{ 'success' if condicoes['status'] == 'vitoria' else 'error' }}">
            <h2>{{ 'ğŸ‰ VITÃ“RIA!' if condicoes['status'] == 'vitoria' else 'ğŸ’€ DERROTA!' }}</h2>
            <p>{{ condicoes['mensagem'] }}</p>
        </div>
        % end

        <!-- Layout 2 linhas x 3 colunas -->
        <div class="game-grid-2x3">
            <!-- LINHA 1 -->
            <!-- Coluna 1: Recursos -->
            <section class="panel recursos-panel">
                <h2>ğŸ“¦ Recursos</h2>
                <div class="recursos-grid">
                    % for nome, recurso in stats['recursos'].items():
                    <div class="recurso-card">
                        <div class="recurso-icon">
                            % if nome == 'comida':
                            ğŸŒ¾
                            % elif nome == 'agua':
                            ğŸ’§
                            % elif nome == 'energia':
                            âš¡
                            % elif nome == 'metal':
                            ğŸ”©
                            % end
                        </div>
                        <div class="recurso-info">
                            <h3>{{ nome.capitalize() }}</h3>
                            <p class="quantidade">{{ recurso['quantidade'] }} / {{ recurso['capacidade_maxima'] }}</p>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: {{ recurso['percentual'] }}%; background-color: {{ '#e74c3c' if recurso['percentual'] < 20 else '#f39c12' if recurso['percentual'] < 50 else '#27ae60' }}"></div>
                            </div>
                        </div>
                    </div>
                    % end
                </div>
            </section>

            <!-- Coluna 2: EstatÃ­sticas -->
            <section class="panel stats-panel">
                <h2>ğŸ“Š EstatÃ­sticas da ColÃ´nia</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">ğŸ‘¥ Colonos Vivos:</span>
                        <span class="stat-value">{{ stats['colonos_vivos'] }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ’€ Colonos Mortos:</span>
                        <span class="stat-value">{{ stats['colonos_mortos'] }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">â¤ï¸ SaÃºde MÃ©dia:</span>
                        <span class="stat-value">{{ stats['saude_media'] }}%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ˜Š Felicidade MÃ©dia:</span>
                        <span class="stat-value">{{ stats['felicidade_media'] }}%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ—ï¸ EdifÃ­cios:</span>
                        <span class="stat-value">{{ stats['total_edificios'] }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ  Capacidade HabitaÃ§Ã£o:</span>
                        <span class="stat-value">{{ stats['capacidade_habitacao'] }}</span>
                    </div>
                </div>
            </section>

            <!-- Coluna 3: Construir EdifÃ­cios -->
            <section class="panel construcao-panel">
                <h2>ğŸ—ï¸ Construir EdifÃ­cios</h2>
                <div class="edificios-grid-compact">
                    <div class="edificio-card-compact">
                        <h3>ğŸŒ¾ Fazenda</h3>
                        <p class="custo">ğŸ’° 20M, âš¡10E</p>
                        <form action="/construir/fazenda" method="POST">
                            <button type="submit" class="btn btn-build-small">Construir</button>
                        </form>
                    </div>
                    <div class="edificio-card-compact">
                        <h3>ğŸ’§ Purificador</h3>
                        <p class="custo">ğŸ’° 25M, âš¡15E</p>
                        <form action="/construir/purificador" method="POST">
                            <button type="submit" class="btn btn-build-small">Construir</button>
                        </form>
                    </div>
                    <div class="edificio-card-compact">
                        <h3>âš¡ Gerador</h3>
                        <p class="custo">ğŸ’° 40M</p>
                        <form action="/construir/gerador" method="POST">
                            <button type="submit" class="btn btn-build-small">Construir</button>
                        </form>
                    </div>
                    <div class="edificio-card-compact">
                        <h3>ğŸ”© Mina</h3>
                        <p class="custo">ğŸ’° 15M, âš¡5E</p>
                        <form action="/construir/mina" method="POST">
                            <button type="submit" class="btn btn-build-small">Construir</button>
                        </form>
                    </div>
                    <div class="edificio-card-compact">
                        <h3>ğŸ  HabitaÃ§Ã£o</h3>
                        <p class="custo">ğŸ’° 30M, âš¡5E</p>
                        <form action="/construir/habitacao" method="POST">
                            <button type="submit" class="btn btn-build-small">Construir</button>
                        </form>
                    </div>
                    <div class="edificio-card-compact">
                        <h3>ğŸ¥ Hospital</h3>
                        <p class="custo">ğŸ’° 35M, âš¡10E</p>
                        <form action="/construir/hospital" method="POST">
                            <button type="submit" class="btn btn-build-small">Construir</button>
                        </form>
                    </div>
                </div>
            </section>

            <!-- LINHA 2 -->
            <!-- Coluna 1: Colonos -->
            <section class="panel colonos-panel">
                <h2>ğŸ‘¥ Colonos ({{ stats['colonos_vivos'] }})</h2>
                <div class="acoes-colonos">
                    <form action="/contratar_colono" method="POST">
                        <button type="submit" class="btn btn-secondary-small">â• Contratar</button>
                    </form>
                </div>
                <div class="colonos-lista-compact">
                    % for colono in stats['colonos'][:6]:
                    <div class="colono-card-compact">
                        <h4>{{ colono['nome'] }}</h4>
                        <p class="profissao-small">{{ colono['profissao'] }}</p>
                        <div class="colono-stats-compact">
                            <div class="stat-mini">
                                <span>â¤ï¸</span>
                                <div class="mini-progress">
                                    <div class="mini-fill" style="width: {{ colono['saude'] }}%; background-color: {{ '#e74c3c' if colono['saude'] < 30 else '#f39c12' if colono['saude'] < 60 else '#27ae60' }}"></div>
                                </div>
                                <span>{{ colono['saude'] }}%</span>
                            </div>
                            <div class="stat-mini">
                                <span>ğŸ˜Š</span>
                                <div class="mini-progress">
                                    <div class="mini-fill" style="width: {{ colono['felicidade'] }}%; background-color: {{ '#e74c3c' if colono['felicidade'] < 30 else '#f39c12' if colono['felicidade'] < 60 else '#27ae60' }}"></div>
                                </div>
                                <span>{{ colono['felicidade'] }}%</span>
                            </div>
                        </div>
                    </div>
                    % end
                    % if len(stats['colonos']) > 6:
                    <p class="mais-colonos-small">+{{ len(stats['colonos']) - 6 }} colonos</p>
                    % end
                </div>
            </section>

            <!-- Coluna 2: EdifÃ­cios ConstruÃ­dos -->
            <section class="panel edificios-panel">
                <h2>ğŸ›ï¸ EdifÃ­cios ({{ stats['total_edificios'] }})</h2>
                <div class="edificios-lista-compact">
                    % for edificio in stats['edificios'][:8]:
                    <div class="edificio-item-compact">
                        <h4>{{ edificio['nome'] }} (Nv{{ edificio['nivel'] }})</h4>
                        <p>{{ 'âœ…' if edificio['status'] == 'ativo' else 'âš ï¸' }} Prod: {{ edificio['producao_total'] }}</p>
                    </div>
                    % end
                    % if len(stats['edificios']) > 8:
                    <p class="mais-edificios-small">+{{ len(stats['edificios']) - 8 }} edifÃ­cios</p>
                    % end
                </div>
            </section>

            <!-- Coluna 3: Eventos Recentes -->
            <section class="panel eventos-panel">
                <h2>ğŸ“° Eventos Recentes</h2>
                % if stats['eventos_recentes']:
                <div class="eventos-lista-compact">
                    % for evento in reversed(stats['eventos_recentes'][:5]):
                    <div class="evento-item-compact">
                        <h4>{{ evento['nome'] }}</h4>
                        <p>{{ evento['descricao'] }}</p>
                    </div>
                    % end
                </div>
                % else:
                <p class="sem-eventos">Nenhum evento ainda</p>
                % end
            </section>
        </div>

        <footer class="footer">
            <p>Projeto de OrientaÃ§Ã£o a Objetos - UnB | PadrÃ£o MVC | PersistÃªncia com Pickle</p>
        </footer>
    </div>
</body>
</html>

